# <EEG를 이용한 인지부하 시각화 시스템>

## <평가기준 부합성 설명>
### 1. 구현된 EEG 데이터 전처리 기법의 다양성

본 시스템은 EEG 데이터의 전처리를 위해 총 다양한 전처리 조합을 제공합니다. 기본적으로 제공되는 4가지 전처리 기법과 3가지 추가 옵션을 포함하여 다양한 전처리 방식을 지원함으로써 데이터의 품질과 분석의 신뢰도를 높입니다.

- **기본 전처리 기법:**
  - **NaN 값 제거**: 비정상적인 데이터를 제거하여 데이터의 일관성을 확보.
  - **고주파 필터링**: 신호의 저역 필터링을 통해 노이즈 제거.
  - **데이터 Pandas DataFrame 변환**: 데이터 관리를 용이하게 함.
  - **Min-Max 정규화**: 데이터의 범위를 일정하게 조정.

- **추가 전처리 옵션:**
  - **라인 노이즈 제거**: 전원 공급으로 인한 50-60Hz 노이즈 제거.
  - **아티팩트 제거**: 신체적 움직임이나 외부 간섭에 의해 발생하는 신호 왜곡 제거.
  - **평균 재참조(average referencing)**: 신호의 기준점을 설정하여 채널 간 비교를 용이하게 함.

이러한 다양한 전처리 기법의 조합을 통해 사용자는 데이터 특성에 맞는 최적의 전처리 과정을 선택할 수 있습니다.

### 2. 사용된 EEG 모델의 다양성

시스템은 두 가지 주요 모델을 제공하여 EEG 데이터 분석의 다양성을 확보하였습니다:

- **CNN (Convolutional Neural Network)**: 14개의 기본 EEG 채널 데이터를 기반으로 빠르고 효율적인 예측 수행.
- **CNN-FFT**: 각 채널의 데이터를 5개의 주파수 대역으로 세분화하여 총 70개의 특성을 학습함으로써 보다 세밀한 분석을 가능하게 함.

이 두 가지 모델의 병행 사용은 다양한 분석 요구에 대응할 수 있으며, 사용자에게 모델 선택의 유연성을 제공합니다.

### 3. 결과 분석의 깊이와 통찰력

본 시스템은 EEG 데이터 전처리 및 모델링 과정에서 도출된 결과를 다각도로 분석하여 깊이 있는 통찰을 제공합니다:

- **전처리 전후 데이터 비교**: 전처리 전후의 데이터 변화를 시각적으로 비교할 수 있는 그래프와 확대/축소 기능을 제공.
- **SHAP 값 시각화**: 채널별로 정규화된 SHAP 값을 막대 그래프로 표시하여 각 채널이 모델 성능에 미치는 영향을 직관적으로 파악.
- **뇌파 히트맵**: 전처리 전후 그래프의 최대값과 최소값의 차이를 기반으로 뇌파의 사용 정도를 시각화. 값의 차이가 클수록 뇌의 활동이 많다고 간주하여 붉은 계열로, 차이가 적을수록 활동이 적다고 간주하여 푸른 계열으로 표시.
- **신뢰도 순위 그래프**: 전처리와 모델 조합에 따른 최종 신뢰도 값을 기반으로 순위 그래프를 랜더링하여 비교 분석.

이를 통해 사용자는 EEG 데이터를 더욱 직관적이고 효율적으로 분석할 수 있습니다.

### 4. 시각화 시스템의 직관성

본 시스템은 사용자 친화적인 인터페이스를 제공하여 직관적인 시각화를 가능하게 합니다:

- **시각화 영역 분할**: 각 시각화 영역을 분할시켜 사용자가 직관적으로 이해할 수 있는 대시보드 제공.
- **인터랙티브 그래프**: 그래프 위에 신뢰도 값을 표시하고, 사용자 선택에 따라 성능이 높은 순서대로 정렬.
- **확대/축소 및 툴팁 기능**: 데이터의 세부 사항을 쉽게 분석할 수 있도록 확대/축소 및 툴팁 기능 제공.
- **툴팁제공**: 각 그래프마다 툴팁을 제공해서 더욱 직관적으로 이해할 수 있도록 정보 제공.
- **실시간 히트맵**: 시계열데이터를 반복하여 실시간 랜더링 제공.

이러한 기능들은 사용자가 복잡한 데이터를 쉽게 이해하고 분석할 수 있도록 돕습니다.

### 5. 프로젝트 결과물의 실용성

- **사용자 친화적인 대시보드**: 해당 대시보드를 처음 이용하는 사람들에게 메뉴얼을 제공하여 더욱 쉽게 접근할 수 있도록 도움.
- **다양한 전처리 및 모델 조합**: 사용자가 다양한 조합을 시도할 수 있어 실제 연구 및 산업 현장에서 유용하게 활용 가능.
- **효율적인 신뢰도 평가**: 세그먼트 단위로 분할하여 신뢰도 값을 추출함으로써 데이터 분석의 효율성을 높임.
- **제한 사항**: 다소 적은 데이터셋과 과적합 문제로 인해 모델의 신뢰도연 설명>

### 1. 가장 효과적인 전처리 기법 & 모델 조합에 대한 분석을 제공해 줄 수 있는 VA 시스템 개발 <br/>
 이 대시보드는 사용자가 분석하고자 하는 raw 데이터에 대해 선택한 전처리 및 모델 기법을 적용하여 시각화합니다. 각 조합의 신뢰도 값은 그래프 위에 표시되며, 성능이 높은 순서대로 전처리 조합 그래프로 제공됩니다. 이를 통해 사용자는 직접 선택한 전처리 및 모델 기법 조합 중 가장 신뢰도가 높은 조합을 명확히 확인할 수 있습니다.

### 2. VA 시스템은 데이터셋 전처리 기능, 모델 선택 기능 제공 필요<br/>
이 시스템은 데이터셋 전처리 기능과 모델 선택 기능을 제공합니다. 이 대시보드는 EEG raw 데이터를 분석할 때 기본적으로 제공되는 4가지 전처리 방식(NaN 제거, high-pass filter, 데이터 Pandas DataFrame 변환, Min-Max 정규화)과 함께, 사용자가 선택할 수 있는 3가지 추가 옵션(라인 노이즈 제거, artifact 제거, 평균 재참조)을 활용할 수 있도록 설계되었습니다. 이를 통해 총 8가지 전처리 조합을 시도할 수 있습니다. <br/>
또한, 대시보드에서는 두 가지 모델 옵션(CNN, CNN-FFT)을 선택할 수 있으며, 이러한 전처리 방식과 모델 조합으로 총 16가지의 분석 지표를 시각화하고 비교할 수 있습니다. 이를 통해 사용자는 전처리 및 모델 조합 중 가장 적합한 분석 방식을 확인할 수 있습니다.

### 3. 전처리에 대한 시각화 평가 제공<br/>
우리 시스템은 EEG 데이터의 전처리 과정을 시각적으로 평가할 수 있는 다양한 기능을 제공합니다.
먼저 이 시스템에서는 EEG 데이터 전처리 전후 그래프를 랜더링하고 확대/축소 기능과 각 세그먼트에 대한 툴팁을 제공해서 어느 부분이 hi/low인지 사용자가 쉽게 분석할 수 있도록 구현했습니다. 두번째로는 채널별로 정규화된 SHAP 값을 막대 그래프로 표시하여, 각 채널이 모델 성능에 미치는 영향을 직관적으로 파악할 수 있도록 하였습니다. 세번째로는 뇌파의 히트맵입니다. 전처리 전후 그래프의 최대값과 최소값의 차이를 기반으로, 뇌파의 사용 정도를 시각화하였습니다. 값의 차이가 클수록 뇌의 활동이 많다고 간주하여 붉은 계열로, 차이가 적을수록 활동이 적다고 간주하여 푸른 계열로 표시하였습니다. 마지막으로 전처리와 모델 조합에 따른 최종 신뢰도값을 기반으로, 사용자가 조합을 제출할 때마다 순위 그래프를 랜더링하여 비교 분석할 수 있도록 구현하였습니다. 이러한 시각화 기능을 통해, 사용자가 EEG 데이터를 더욱 직관적이고 효율적으로 분석할 수 있도록 지원하였습니다.

### 4. 모델의 신뢰도 분석 기법
저희 시스템은 2D CNN을 활용하여 EEG raw 데이터를 120 크기의 세그먼트로 분할한 뒤, 각 세그먼트가 hi/low인지 판단하는 이진 분류 모델을 학습하였습니다. 전체 그래프를 학습시키는 방식보다 효율적이라고 판단하여, 세그먼트 단위로 분할하여 학습을 진행하였으며, 이를 통해 각 세그먼트의 신뢰도 값을 추출할 수 있도록 설계하였습니다. 다만, 데이터가 모델을 통과하며 세그먼트 분할 및 신뢰도 값 추출 과정을 거치기 때문에 랜더링 시간이 다소 소요된다는 점이 한계로 지적됩니다. 이러한 분석 기법은 EEG 데이터를 기반으로 한 인지 부하 모델의 신뢰도를 효율적으로 평가하기 위한 접근 방식으로 설계되었습니다.
   
### 5. 다양한 인지 부하 모델
본 프로젝트에서는 기본으로 제공되는 전처리 방법을 제외한 총 16가지의 전처리 및 모델 조합을 구현하였습니다. 각 조합에 따라 개별 모델을 학습시켰으며, 사용자 인터페이스의 메뉴창을 통해 원하는 전처리 및 모델 조합을 선택하여 적용할 수 있도록 하였습니다. 이를 통해 다양한 전처리 기법과 모델의 성능을 체계적으로 비교 분석할 수 있었으며, 최적의 인지 부하 분류 성능을 달성하기 위한 최적의 조합을 식별할 수 있었습니다. 하지만 적은 데이터셋과 과적합으로 인해서 모델의 신뢰도 결과값이 잘 나오지 않은것이 아쉬운 점 중 하나입니다.
   
## 메뉴바 
![image](https://github.com/user-attachments/assets/708b52e3-41a9-4554-89ec-2dbfee1ab789)
- 설명서 보기 버튼으로 대시보드의 전체적인 설명을 읽을 수 있게 구현
- 40 ~ 48번의 피실험자 raw 데이터 선택 + 전처리 선택 + 모델 선택 후 제출 버튼으로 동작 시작
![image](https://github.com/user-attachments/assets/40586294-e306-46e4-b71c-69d08bb59930)
- 터미널에 위와 같은 문구가 2번 뜨면 화면에 랜더링 시작

## <설명서 페이지>
![image](https://github.com/user-attachments/assets/0a732de5-e596-4bb6-a6d7-4292914ab5ea)
- 설명서 페이지에 해당 대시보드 시각화에 사용하는 총 14개의 채널에 대한 정보를 시각화

## <그래프 시각화 페이지>
![image](https://github.com/user-attachments/assets/779dc196-2970-4bc2-bb61-556cb58fab91)

- 랜더링 후 선탣된 피실험자의 raw데이터의 (hi, low) 그래프와 전처리 + 모델의 (hi, low) 값이 랜더링
- 그래프를 마우스를 이용해서 확대 축소가 가능하며, 그래프 세그먼트에 대한 툴팁도 제공
---
![image](https://github.com/user-attachments/assets/885fa766-8314-498f-abd5-770e513b3b52)
- 그래프 시각화 밑에는 전처리된 각각의 채널에 대한 셰플리값을 정규화해서 시각화
- CNN 버전은 총 14개의 라벨 그리고 CNN_FFT 버전은 총 70개의 라벨(채널 + 대역폭 조합)에 대한 값을 표시


## <토포그래피 시각화 페이지>
![image](https://github.com/user-attachments/assets/67d33be2-1052-4db9-8a42-af405301a987)
- 뇌파 데이터의 max값과 min값의 오차범위가 클수록 붉은계열로 각 채널별 등고선으로 표시
- 각 그래프는 시계열 데이터를 while 문으로 반복하면서 변동값을 실시간으로 시각화
- FFT 버전은 각 대역폭에 대한 시각화 그래프가 존재. 일반 모델은 각각 1개씩만 존재

## <전처리 조합 페이지>
![image](https://github.com/user-attachments/assets/2899104b-8907-4dc5-a1f9-30f600524dac)
- 각 전처리 + 모델의 최종 신뢰도값을 이용해서 순위를 실시간으로 변동시키는 그래프
- 제출을 하고 해당 페이지로 이동하면 약간의 딜레이 후에 그래프 변동
- 최대 성능이 좋은 조합의 5개의 순위까지만 표시


# <Flask 프로젝트 실행 방법>
### 1. 필요한 패키지 설치
- `requirements.txt` 파일에 정의된 의존성을 설치합니다.
```bash
pip install -r requirements.txt
```
```bash
flask run
```
