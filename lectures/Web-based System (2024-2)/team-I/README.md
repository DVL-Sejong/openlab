# 차원 축소 및 클러스터링 시스템

이 프로젝트는 "최적의 차원 축소 및 클러스터링 유도 후 결과 분석"을 목표로, MNIST 데이터셋을 활용하여 차원 축소 및 클러스터링 결과를 분석하고 시각화하는 웹 애플리케이션입니다.  
---

## 주요 기능
- **데이터셋**  
  - MNIST 데이터셋(0~9 숫자 손글씨 이미지) 활용.  
  - 총 70,000개(훈련: 60,000개, 테스트: 10,000개) 데이터 분석.
- **차원 축소 기법**  
  - CNN 기반 특징 추출 후, UMAP 및 t-SNE 기법 적용.
- **클러스터링 알고리즘**  
  - UMAP: K-Means 적용.  
  - t-SNE: HDBSCAN 적용.  
- **시각화 및 분석**  
  - Box Plot, Scatter Plot, Noise 탐지.  
  - 클러스터 간 유사도 및 클러스터 내부 데이터 분석.

---

## 실행 방법

### 0. ** Python 버전 3.11.2 이하 사용 **

### 1. 가상환경 생성
```bash
python -m venv venv
```

### 2. 가상환경 활성화
```bash
venv\Scripts\activate
```

### 3. 종속성 설치
```bash
pip install -r requirements.txt
```

### 4. 데이터 파일 생성
- clustering_after_cnn.ipynb 파일 Run All 
- 최소 15분 시간 소요

### 5. 웹 시스템 실행
```bash
python app.py
```

브라우저에서 `http://localhost:5000`으로 접속하여 애플리케이션을 확인할 수 있습니다.

---

## 프로젝트 구조

```plaintext
data/
    tnse(umap)_cluster_boundary.json      # 클러스터링 영역 설정 데이터
    tsne(umap)_clustering.json            # 클러스터링 결과 데이터
    tsne(umap)_noise_counts.csv           # 클러스터별 Noise 개수 데이터
    tsne(umap)_representative_value.json  # 클러스터 대표 이미지 데이터
    tsne(umap)_box_plot_data.csv          # Box Plot 데이터
    tsne(umap)_cosine_similarity.csv      # 코사인 유사도 데이터

models/
    cnn_model.pth                         # 특징 추출을 위한 CNN 모델

notebooks/
    clustering_after_cnn.ipynb            # CNN 모델 결과로 차원 축소
    cnn_explain.ipynb                     # CNN 모델 설명
    cnn_model.ipynb                       # CNN 모델 정의
    default_dim_reduction.ipynb           # 원본 데이터의 차원 축소

static/
    css/
        style.css                         # 스타일 및 레이아웃 정의 CSS
    js/
        boxPlot.js                        # Box Plot 시각화
        generateKey.js                    # 데이터 포인트 고유 키 생성
        main.js                           # JavaScript 로직 시작점
        noiseImage.js                     # 오분류 데이터 시각화
        drawOutlierByNoise.js             # 오분류 데이터 내 Box Plot 이상치 개수 시각화
        scatterPlot.js                    # 전체 산점도 시각화
        scatterPlotByCluster.js           # 선택된 클러스터 산점도 시각화

templates/
    index.html                            # 메인 HTML 파일

app.py                                    # Flask 웹 애플리케이션 메인 스크립트
```

---

## 분석 결과 요약

### 차원 축소 결과
- **UMAP**: 전역적 구조를 보존하지 못해 군집 간의 거리가 가까웠음.  
- **t-SNE**: 지역적 구조를 보존하지 못해 군집 간 데이터 혼재가 많았음.  
- **CNN 기반 특징 추출 후**:
  - UMAP: 군집 간 거리 증가 → 전역적 구조 보존성 상승.  
  - t-SNE: 군집 간 데이터 혼재 감소 → 지역적 구조 보존성 상승.  

### 클러스터링
- **UMAP + K-Means**:
  - UMAP은 전역적 구조와 지역적 구조의 보존성이 높아 K-Means 알고리즘을 적용함.
  - 클러스터링 결과, 특정 클러스터(예: 클러스터 0)가 라벨 0의 데이터 분포가 가장 높은 클러스터라고 가정했을 때,  
    해당 클러스터 내에서 다른 라벨의 데이터는 모두 노이즈로 간주함.
  - 이 기준으로 모든 클러스터의 노이즈 데이터를 합산한 결과, **총 70,000개의 데이터 중 1,010개**가 노이즈로 분류됨.
- **t-SNE + HDBSCAN**:
  - t-SNE는 K-Means를 적용하기에 충분한 전역적 구조와 지역적 구조를 보존하지 못하였기 때문에,  
  HDBSCAN 알고리즘을 적용하여 클러스터링을 진행함.
  - HDBSCAN 결과:
    - 노이즈를 포함하여 총 **13개의 클러스터** 생성.
    - 클러스터 이름을 해당 클러스터에서 가장 많이 나타나는 라벨로 변경 후,  
      - 노이즈 포함 시: 총 **11개의 클러스터** 형성.
      - 노이즈를 가장 가까운 클러스터로 편입 시: 총 **10개의 클러스터** 형성.
  - 특정 클러스터(예: 클러스터 0)가 라벨 0의 데이터 분포가 가장 높은 클러스터라고 가정했을 때,  
    해당 클러스터 내에서 다른 라벨의 데이터는 모두 노이즈로 간주함.
  - 이 기준으로 모든 클러스터의 노이즈 데이터를 합산한 결과, **총 70,000개의 데이터 중 964개**가 잘못 클러스터링된 것으로 나타남.

### 클러스터링 결과 분석
- **코사인 유사도 분석**:
  - 클러스터 내 유사도가 클러스터 간 유사도보다 높음을 확인.  
- **Box Plot 시각화**:
  - Noise 데이터는 이상치로 분류되는 경우가 많음을 확인.  

---

## 사용 기술
- **프론트엔드**: HTML5, CSS3, Bootstrap 5, D3.js  
- **백엔드**: Flask (Python)  
- **모델 및 데이터 처리**: PyTorch, NumPy, pandas  
- **차원 축소 기법**: t-SNE, UMAP  

---

## 평가 기준별 대응

### Dimensionality Reduction 기술의 구현 (10%)
- 프로젝트는 UMAP과 t-SNE 기법을 구현하였으며, 데이터 특징을 효과적으로 차원 축소하여 분석 가능한 형태로 변환하였습니다.

### Dimensionality Reduction 기술의 정상 작동 근거 제시 (10%)
- UMAP과 t-SNE를 활용한 클러스터링 결과를 통해 정상 작동을 증명하였습니다.
  - UMAP: 전역적 구조를 보존하며 K-Means와 결합하여 높은 신뢰도의 클러스터링을 수행.
  - t-SNE: 지역적 구조를 보존하며 HDBSCAN을 적용해 노이즈를 포함한 효과적인 클러스터링을 수행.

### 군집 내 데이터의 유사도 분석 제공 (25%)
- 군집 내 유사도를 코사인 유사도로 분석하여, 노이즈 데이터와 대표 이미지 간의 유사도를 수치적으로 비교하였습니다.
- 대부분의 노이즈 데이터가 0.65 이하의 유사도를 가지며, 노이즈로 간주할 수 있음을 확인.

### 군집 간 데이터 차이 분석 제공 (25%)
- UMAP과 t-SNE 결과를 통해 군집 간 데이터 분리를 시각화 및 정량화하여, 군집 간 차이를 명확히 제시.
- 추가적으로 코사인 유사도를 활용한 Box Plot 시각화 결과, 0부터 9까지의 각 클러스터에 대해 해당 클러스터가 아닌 데이터의 유사도가 낮게 나타남을 확인하였습니다. 이 분석은 각 라벨별로 명확한 군집 간 차이를 정량적으로 증명하였습니다.

### 개발한 시각화, 유사도 비교 지표, 분석 플로우의 정당성 (30%)
- **시각화**: Box Plot, Scatter Plot 등을 통해 분석 결과를 직관적으로 확인 가능합니다. Box Plot은 각 클러스터의 데이터 분포를 명확히 보여주며, Scatter Plot은 군집 간의 전반적인 분포와 관계를 시각적으로 표현하여 군집의 명확성을 뒷받침합니다.
- **유사도 비교 지표**: 코사인 유사도는 군집 내 데이터와 대표 이미지 간의 정량적 비교를 가능하게 하며, 특히 노이즈 데이터의 유사도를 낮게 확인함으로써 분석 결과의 신뢰도를 제고합니다. 이는 군집 내외 데이터의 명확한 분리 기준을 제공하는 핵심적인 지표입니다.
- **분석 플로우의 정당성**: 분석 플로우는 다음과 같은 근거에서 정당성을 갖습니다:
  1. **CNN 기반 특징 추출**: MNIST 데이터의 고차원 특성을 효과적으로 파악하여 차원 축소의 기반 데이터를 제공.
  2. **차원 축소 단계**: UMAP과 t-SNE는 각각 전역적 구조와 지역적 구조를 보존하며, 데이터 분리 및 분석에 적합한 결과를 생성.
  3. **클러스터링**: K-Means와 HDBSCAN 알고리즘을 활용하여 데이터 분포와 특성에 따른 군집화를 수행, 노이즈를 포함한 데이터도 처리 가능.
  4. **유사도 분석**: 코사인 유사도를 사용하여 군집 내외 데이터를 정량적으로 비교하고, 이를 Box Plot으로 시각화하여 정량적 결과를 직관적으로 이해 가능하도록 지원.
  5. **전체 흐름**: 각 단계는 이전 단계의 결과를 기반으로 설계되어 있어, 데이터 처리 및 분석 과정의 일관성과 효율성을 보장.

---

## 자세한 내용은 보고서에 작성...